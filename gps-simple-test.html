<!DOCTYPE html>
<html>
<head>
    <title>GPSåŸºç¤æ¸¬è©¦</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border: 1px solid;
        }
        .success { background: #e6f7e6; border-color: #2ecc71; }
        .error { background: #ffe6e6; border-color: #e74c3c; }
        .info { background: #e6f3ff; border-color: #3498db; }
        button {
            padding: 12px 24px;
            margin: 10px 5px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .results {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .step {
            margin: 10px 0;
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§­ GPSåŸºç¤æ¸¬è©¦</h1>
    <p>é€™å€‹é é¢åªæœ‰æœ€åŸºç¤çš„GPSåŠŸèƒ½ï¼Œæ‡‰è©²èƒ½å¤ æ­£å¸¸é‹è¡Œã€‚</p>

    <div class="status info" id="status">
        è«‹é»æ“Šä¸‹æ–¹"æ¸¬è©¦GPS"æŒ‰éˆ•é–‹å§‹
    </div>

    <button onclick="testGPS()" id="test-btn">æ¸¬è©¦GPS</button>

    <div class="results">
        <h3>ä½ç½®ä¿¡æ¯ï¼š</h3>
        <p><strong>ç·¯åº¦ï¼š</strong> <span id="latitude">-</span></p>
        <p><strong>ç¶“åº¦ï¼š</strong> <span id="longitude">-</span></p>
        <p><strong>ç²¾åº¦ï¼š</strong> <span id="accuracy">-</span> ç±³</p>
        <p><strong>æ™‚é–“ï¼š</strong> <span id="timestamp">-</span></p>
    </div>

    <div class="status info">
        <h4>ä½¿ç”¨èªªæ˜ï¼š</h4>
        <div class="step">1. é»æ“Š"æ¸¬è©¦GPS"æŒ‰éˆ•</div>
        <div class="step">2. å…è¨±ç€è¦½å™¨è¨ªå•æ‚¨çš„ä½ç½®</div>
        <div class="step">3. ç­‰å¾…ä½ç½®ä¿¡æ¯é¡¯ç¤º</div>
        <div class="step">4. å¦‚æœæˆåŠŸï¼Œæ‚¨å°‡çœ‹åˆ°ç¶“ç·¯åº¦ä¿¡æ¯</div>
    </div>

    <script>
        function testGPS() {
            const statusEl = document.getElementById('status');
            const testBtn = document.getElementById('test-btn');
            
            // æª¢æŸ¥ç€è¦½å™¨æ˜¯å¦æ”¯æŒGPS
            if (!navigator.geolocation) {
                statusEl.textContent = "âŒ æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æŒGPSåŠŸèƒ½";
                statusEl.className = "status error";
                return;
            }

            statusEl.textContent = "ğŸ“ è«‹æ±‚ä½ç½®æ¬Šé™ä¸­...";
            statusEl.className = "status info";
            testBtn.disabled = true;
            testBtn.textContent = "ç²å–ä½ç½®ä¸­...";

            // ä½¿ç”¨æœ€ç°¡å–®çš„getCurrentPositionè€Œä¸æ˜¯watchPosition
            navigator.geolocation.getCurrentPosition(
                // æˆåŠŸå›èª¿
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const acc = position.coords.accuracy;
                    
                    // æ›´æ–°é¡¯ç¤º
                    document.getElementById('latitude').textContent = lat.toFixed(6);
                    document.getElementById('longitude').textContent = lng.toFixed(6);
                    document.getElementById('accuracy').textContent = Math.round(acc);
                    document.getElementById('timestamp').textContent = new Date().toLocaleTimeString();
                    
                    statusEl.textContent = "âœ… GPSæ¸¬è©¦æˆåŠŸï¼ä½ç½®ä¿¡æ¯å·²ç²å–";
                    statusEl.className = "status success";
                    testBtn.textContent = "å†æ¬¡æ¸¬è©¦";
                    testBtn.disabled = false;
                },
                // éŒ¯èª¤å›èª¿
                function(error) {
                    let errorMessage = "ç²å–ä½ç½®å¤±æ•—ï¼š";
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = "âŒ ä½ç½®æ¬Šé™è¢«æ‹’çµ•ã€‚è«‹å…è¨±ç€è¦½å™¨è¨ªå•æ‚¨çš„ä½ç½®ï¼Œç„¶å¾Œé‡è©¦ã€‚";
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = "âŒ ç„¡æ³•ç²å–ä½ç½®ä¿¡æ¯ã€‚è«‹æª¢æŸ¥GPSä¿¡è™Ÿæˆ–ç¶²çµ¡é€£æ¥ã€‚";
                            break;
                        case error.TIMEOUT:
                            errorMessage = "âŒ ç²å–ä½ç½®è¶…æ™‚ã€‚è«‹é‡è©¦ã€‚";
                            break;
                        default:
                            errorMessage = "âŒ æœªçŸ¥éŒ¯èª¤ï¼š" + error.message;
                            break;
                    }
                    
                    statusEl.textContent = errorMessage;
                    statusEl.className = "status error";
                    testBtn.textContent = "é‡æ–°æ¸¬è©¦";
                    testBtn.disabled = false;
                },
                // é¸é … - ä½¿ç”¨è¼ƒçŸ­è¶…æ™‚æ™‚é–“
                {
                    enableHighAccuracy: true,
                    timeout: 10000, // 10ç§’è¶…æ™‚
                    maximumAge: 0
                }
            );
        }

        // é é¢åŠ è¼‰æ™‚é¡¯ç¤ºåŸºæœ¬ä¿¡æ¯
        window.addEventListener('load', function() {
            const statusEl = document.getElementById('status');
            if (navigator.geolocation) {
                statusEl.textContent = "âœ… ç€è¦½å™¨æ”¯æŒGPSï¼Œè«‹é»æ“Šæ¸¬è©¦æŒ‰éˆ•é–‹å§‹";
            } else {
                statusEl.textContent = "âŒ ç€è¦½å™¨ä¸æ”¯æŒGPSåŠŸèƒ½";
                statusEl.className = "status error";
            }
        });
    </script>
</body>
</html>
