<!DOCTYPE html>
<html>
<head>
    <title>GPS測試</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { padding: 10px; margin: 10px 0; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        .info { background: #d1ecf1; }
    </style>
</head>
<body>
    <h1>GPS功能測試</h1>
    
    <button onclick="startGPS()">開始GPS測試</button>
    <button onclick="stopGPS()">停止GPS</button>
    
    <div id="status" class="status info">
        點擊"開始GPS測試"按鈕開始
    </div>
    
    <div id="results">
        <p><strong>經度:</strong> <span id="longitude">-</span></p>
        <p><strong>緯度:</strong> <span id="latitude">-</span></p>
        <p><strong>精度:</strong> <span id="accuracy">-</span> 米</p>
        <p><strong>最後更新:</strong> <span id="timestamp">-</span></p>
    </div>

    <script>
        let watchId = null;
        
        function startGPS() {
            if (!navigator.geolocation) {
                showStatus("您的瀏覽器不支持GPS功能", "error");
                return;
            }
            
            showStatus("正在請求GPS權限...", "info");
            
            // 請求高精度位置
            const options = {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            };
            
            watchId = navigator.geolocation.watchPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const acc = position.coords.accuracy;
                    
                    document.getElementById('latitude').textContent = lat;
                    document.getElementById('longitude').textContent = lng;
                    document.getElementById('accuracy').textContent = acc;
                    document.getElementById('timestamp').textContent = new Date().toLocaleTimeString();
                    
                    showStatus(`GPS信號正常！精度: ${acc}米`, "success");
                },
                function(error) {
                    let errorMessage = "無法獲取位置: ";
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage += "用戶拒絕了位置請求";
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage += "位置信息不可用";
                            break;
                        case error.TIMEOUT:
                            errorMessage += "請求位置超時";
                            break;
                        default:
                            errorMessage += "未知錯誤";
                            break;
                    }
                    showStatus(errorMessage, "error");
                },
                options
            );
        }
        
        function stopGPS() {
            if (watchId) {
                navigator.geolocation.clearWatch(watchId);
                watchId = null;
                showStatus("GPS已停止", "info");
            }
        }
        
        function showStatus(message, type) {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
        }
    </script>
</body>
</html>
