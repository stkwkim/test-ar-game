<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ä¹é¾åŸæ©Ÿå¯†æª”æ¡ˆ - Level 1">
    <title>ä¹é¾åŸæ©Ÿå¯†æª”æ¡ˆ - Level 1</title>
    
    <!-- ARæ ¸å¿ƒå‡½å¼åº«ï¼ˆCDNè¼‰å…¥ï¼Œç¢ºä¿ç¶²çµ¡é€£æ¥ï¼‰ -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
    
    <!-- GPSå®šä½æ¨¡çµ„ï¼ˆè‡ªè¡Œç·¨å¯«ï¼Œç„¡éœ€ä¿®æ”¹ï¼‰ -->
    <script>
        // GPSå®šä½çµ„ä»¶
        AFRAME.registerComponent('gps-position', {
            schema: {
                latitude: {type: 'number', default: 0},
                longitude: {type: 'number', default: 0}
            },
            init: function() {
                const options = { 
                    enableHighAccuracy: true, 
                    maximumAge: 0, 
                    timeout: 10000 
                };
                
                if (!navigator.geolocation) {
                    this.showError("âŒ æ­¤è£ç½®ä¸æ”¯æ´GPSå®šä½");
                    return;
                }
                
                // ç‹€æ…‹é¡¯ç¤º
                this.updateStatus("ğŸ›°ï¸ GPSå®šä½ä¸­...");
                
                navigator.geolocation.watchPosition(
                    (position) => {
                        const latDiff = position.coords.latitude - this.data.latitude;
                        const lonDiff = position.coords.longitude - this.data.longitude;
                        const distance = Math.sqrt(latDiff*latDiff + lonDiff*lonDiff) * 111000;
                        
                        // â†“â†“â†“ å¯èª¿æ•´è§¸ç™¼ç¯„åœï¼ˆç±³ï¼‰ â†“â†“â†“
                        if (distance < 15) { 
                            this.el.setAttribute('visible', true);
                            this.updateStatus(`âœ… ç›®æ¨™åœ¨${Math.round(distance)}ç±³å…§ï¼ARå…§å®¹å·²è§£é–`);
                        } else {
                            this.el.setAttribute('visible', false);
                            this.updateStatus(`ğŸš¶ è·é›¢ç›®æ¨™é‚„æœ‰${Math.round(distance)}ç±³`);
                        }
                    },
                    (error) => {
                        let errorMsg = "";
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMsg = "âŒ è«‹å…è¨±ç€è¦½å™¨å­˜å–GPSå®šä½";
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMsg = "âŒ ç„¡æ³•ç²å–ä½ç½®è³‡è¨Šï¼Œè«‹æª¢æŸ¥GPSè¨Šè™Ÿ";
                                break;
                            case error.TIMEOUT:
                                errorMsg = "âŒ GPSå®šä½è¶…æ™‚ï¼Œè«‹é‡æ–°æ•´ç†";
                                break;
                        }
                        this.showError(errorMsg);
                    },
                    options
                );
            },
            updateStatus: function(message) {
                const statusBar = document.getElementById('status-bar');
                if (statusBar) {
                    statusBar.textContent = message;
                    statusBar.style.background = 'rgba(0,0,0,0.7)';
                }
            },
            showError: function(message) {
                const errorEl = document.createElement('div');
                errorEl.style.cssText = `
                    position: fixed; 
                    top: 20%; 
                    left: 10%; 
                    right: 10%; 
                    background: #d32f2f; 
                    color: white; 
                    padding: 15px; 
                    border-radius: 8px; 
                    z-index: 9999; 
                    font-family: Arial; 
                    font-size: 14px;
                `;
                errorEl.innerHTML = `<strong>ç³»çµ±æç¤ºï¼š</strong><br>${message}<br><small>è«‹ç¢ºä¿GPSå·²é–‹å•Ÿä¸¦å…è¨±ç€è¦½å™¨å­˜å–</small>`;
                document.body.appendChild(errorEl);
                setTimeout(() => errorEl.remove(), 8000);
            }
        });
        
        // ç¤¾äº¤åˆ†äº«å¼·åˆ¶çµ„ä»¶
        AFRAME.registerComponent('social-share-lock', {
            init: function() {
                this.el.addEventListener('loaded', () => {
                    // é¡¯ç¤ºåˆ†äº«æç¤º
                    setTimeout(() => {
                        const sharePrompt = document.createElement('div');
                        sharePrompt.style.cssText = `
                            position: fixed; 
                            bottom: 20px; 
                            left: 10%; 
                            right: 10%; 
                            background: rgba(0, 123, 255, 0.9); 
                            color: white; 
                            padding: 15px; 
                            border-radius: 10px; 
                            z-index: 9999; 
                            font-family: Arial; 
                            font-size: 16px;
                            text-align: center;
                        `;
                        sharePrompt.innerHTML = `
                            <strong>ğŸ“¸ ä»»å‹™è¦æ±‚ï¼</strong><br>
                            è«‹æˆªåœ–æ­¤ARç•«é¢æˆ–èˆ‡å ´æ™¯è‡ªæ‹<br>
                            åˆ†äº«åˆ°Instagram/Facebookä¸¦æ¨™ç±¤ #ä¹é¾åŸè§£è¬<br>
                            <small>å®Œæˆå¾Œç³»çµ±å°‡é¡¯ç¤ºä¸‹ä¸€é—œåº§æ¨™</small>
                        `;
                        document.body.appendChild(sharePrompt);
                        
                        // æ¨¡æ“¬æª¢æŸ¥åˆ†äº«ï¼ˆå¯¦éš›éœ€æ‰‹å‹•ç¢ºèªï¼‰
                        setTimeout(() => {
                            sharePrompt.innerHTML = `
                                <strong>âœ… åˆ†äº«æª¢æ¸¬å®Œæˆï¼</strong><br>
                                è«‹è¼¸å…¥å½±ç‰‡ä¸­çš„å¯†ç¢¼ç¹¼çºŒä»»å‹™
                            `;
                            setTimeout(() => sharePrompt.remove(), 5000);
                        }, 10000);
                    }, 3000);
                });
            }
        });
    </script>
    
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
        }
        #status-bar {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: #0f0;
            padding: 10px 15px;
            border-radius: 5px;
            z-index: 1000;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-width: 80%;
        }
    </style>
</head>
<body>
    <!-- ç³»çµ±ç‹€æ…‹åˆ— -->
    <div id="status-bar">ğŸ”„ ç³»çµ±åˆå§‹åŒ–ä¸­...</div>
    
    <!-- ARå ´æ™¯ -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        
        <!-- â†“â†“â†“ æ›¿æ›å€1ï¼šLevel 1 GPSåº§æ¨™ â†“â†“â†“ -->
        <a-entity gps-position="latitude: 22.331456; longitude: 114.189234" visible="false">
            
            <!-- å½±ç‰‡è¼‰é«”ï¼ˆå¼·åˆ¶åˆ†äº«çµ„ä»¶ï¼‰ -->
            <a-video 
                src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&mute=0&playsinline=1" 
                width="6" 
                height="3.5" 
                position="0 2 -8"
                rotation="0 0 0"
                material="transparent: true; opacity: 0.95"
                social-share-lock>
            </a-video>
            
            <!-- å¯†ç¢¼æç¤ºæ–‡å­— -->
            <a-text 
                value="ç·šç´¢ï¼šæ¸…æ‹†å¹´ä»½ - 500 = ?" 
                position="0 0.5 -5" 
                align="center"
                color="#FFD700"
                scale="2.5 2.5 2.5">
            </a-text>
            
            <!-- ç¤¾äº¤åˆ†äº«æŒ‰éˆ•ï¼ˆè¦–è¦ºæç¤ºï¼‰ -->
            <a-plane
                position="0 -1 -5"
                width="3"
                height="0.5"
                color="#1DA1F2"
                material="transparent: true; opacity: 0.8">
            </a-plane>
            <a-text 
                value="é»æ“Šåˆ†äº«" 
                position="0 -1 -4.9" 
                align="center"
                color="#FFFFFF"
                scale="1.5 1.5 1.5">
            </a-text>
        </a-entity>
        
        <!-- ç›¸æ©Ÿå¯¦é«” -->
        <a-entity camera gps-camera></a-entity>
    </a-scene>
</body>
</html>
