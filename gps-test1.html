<!-- ✅ 只需把下面整段 <script> 替換掉你原來的即可 -->
<script>
/* ================= 原版邏輯（僅加詩意過場） ================= */
let currentLocation = 1;
const totalLocations = 6;
const hintCounters = {1:0,2:0,3:0,4:0,5:0,6:0};

/* ---- 詩意提示池 ---- */
const poemLines = [
  "風吹過舊城磚，腳步引著故事蔓延。",
  "下一頁，磚瓦將低語；向前行，歲月會回應。",
  "石階藏著遠去的腳聲，等你去輕輕喚醒。",
  "轉角的光，替歷史點燈；你的影子，成為導航。",
  "時間的縫隙在下一個門環，推開便是回聲。"
];

/* ---- 公用函式 ---- */
function randPoem(){
  return poemLines[Math.floor(Math.random()*poemLines.length)];
}

function showPoemThenNext(){
  // 隱藏目前題目
  document.getElementById('location-'+currentLocation).style.display='none';

  // 建立詩意過場畫面
  const wrap = document.createElement('div');
  wrap.id = 'poem-mask';
  wrap.innerHTML = `
    <div style="
      position:fixed; inset:0; background:rgba(0,0,0,.75);
      display:flex; align-items:center; justify-content:center;
      color:#fff; font-size:1.6rem; text-align:center;
      padding:2rem; z-index:9999;">
      <div>
        <p style="margin:0 0 2rem 0; letter-spacing:1px;">${randPoem()}</p>
        <button class="btn btn-success" onclick="goNextLocation()">出發下一地點</button>
      </div>
    </div>`;
  document.body.appendChild(wrap);
}

function goNextLocation(){
  // 移除詩意畫面
  const mask = document.getElementById('poem-mask');
  if(mask) mask.remove();

  currentLocation++;
  updateProgress();
  if(currentLocation<=totalLocations){
    document.getElementById('location-'+currentLocation).style.display='block';
  }else{
    completeGame();
  }
}

/* ---- 問答核心（僅改這裡的流向） ---- */
function checkAnswer(locationNum,correctAnswer){
  const userAnswer=document.getElementById('answer-'+locationNum).value.trim().toLowerCase();
  const correct=correctAnswer.toLowerCase();
  let isCorrect=false;
  if(userAnswer===correct||userAnswer.includes(correct)||correct.includes(userAnswer)) isCorrect=true;
  if(correct==='1950'&&(userAnswer==='50年代'||userAnswer==='五十年代')) isCorrect=true;

  if(isCorrect){
    // 清空輸入框
    document.getElementById('answer-'+locationNum).value='';
    showPoemThenNext();
  }else{
    alert('❌ 答案不正確，請再試一次或查看提示。\n\n提示：答案通常是1-3個字的關鍵詞。');
  }
}

/* ---- 其餘函式保持不變 ---- */
function showHint(locationNum){
  hintCounters[locationNum]++;
  document.getElementById('hint-count-'+locationNum).textContent=hintCounters[locationNum];
  const hints={
    1:{1:'提示：答案就在問題中！留意「衙門」這個詞。',2:'提示：清代衙門的重要建築結構就是「衙門」本身。',3:'答案：衙門'},
    2:{1:'提示：想想香港戰後重建的時期，答案是四位數字。',2:'提示：1950年代是香港戰後重建的重要時期。',3:'答案：1950'},
    3:{1:'提示：這個地方原本的用途與「牛」有關，答案是三個字。',2:'提示：這裡原本是處理牛隻的地方。',3:'答案：屠宰場'},
    4:{1:'提示：答案就在問題中！是一種與海洋生物有關的石頭。',2:'提示：這種石頭形狀像魚的尾巴。',3:'答案：魚尾石'},
    5:{1:'提示：想想中國歷史中南北宋的時期，答案是兩個字。',2:'提示：南宋是宋朝的後期階段。',3:'答案：南宋'},
    6:{1:'提示：答案就在廟宇名稱中！',2:'提示：觀音廟主要供奉的就是觀音菩薩。',3:'答案：觀音'}
  };
  alert(hints[locationNum][Math.min(hintCounters[locationNum],3)]);
  if(hintCounters[locationNum]===3){
    setTimeout(()=>{ hintCounters[locationNum]=0; document.getElementById('hint-count-'+locationNum).textContent='0'; },2000);
  }
}

function showVideo(locationNum,type){/* 原內容不變 */}
function closeVideo(){/* 原內容不變 */}
function updateProgress(){/* 原內容不變 */}
function completeGame(){/* 原內容不變 */}
function resetGame(){/* 原內容不變 */}

/* ================= GPS / 自拍 等其餘腳本保持原樣 ================= */
/* …下方接你原本的 GPS、自拍、WhatsApp 分享程式碼即可… */
</script>
