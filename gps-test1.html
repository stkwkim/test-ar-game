<!DOCTYPE html>
<html>
<head>
    <title>GPSç‰ˆæœ¬ - ä¹é¾åŸåœŸç“œç£æ¢ç´¢</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
        }
        .location-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        .btn:hover {
            background: #5a6fd8;
        }
        .btn-success {
            background: #28a745;
        }
        .btn-hint {
            background: #ffc107;
            color: black;
        }
        .btn-video {
            background: #dc3545;
        }
        .btn-story {
            background: #17a2b8;
        }
        .btn-dev {
            background: #6c757d;
        }
        input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        .completion {
            background: #d4edda;
            color: #155724;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            display: none;
        }
        .progress-container {
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.5s ease;
        }
        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
        }
        /* å½±ç‰‡æ¨¡æ…‹æ¡†æ¨£å¼ */
        .video-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .video-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            text-align: center;
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 æ¯”ä¾‹ */
            height: 0;
            margin: 20px 0;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }
        .close-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .video-description {
            margin: 15px 0;
            color: #555;
            font-style: italic;
        }
        .ar-note {
            background: #e7f3ff;
            color: #004085;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.9em;
        }
        .dev-tools {
            margin-top: 30px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 8px;
        }
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 10px 0;
        }
        .hint-counter {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 5px;
            text-align: center;
        }
        /* äºŒç¶­ç¢¼æ¨£å¼ */
        .qr-code {
            margin: 20px auto;
            text-align: center;
        }
        .qr-code img {
            max-width: 200px;
            border: 2px solid #333;
            border-radius: 10px;
        }
        .qr-instruction {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }
        .gps-status {
            padding: 10px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
        }
        .gps-active {
            background: #d4edda;
            color: #155724;
        }
        .gps-inactive {
            background: #f8d7da;
            color: #721c24;
        }
        .location-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1001;
            display: none;
        }
    </style>
</head>
<body>
    <div class="location-notification" id="location-notification">
        ğŸ‰ æ‚¨å·²åˆ°é”æ–°åœ°é»ï¼æ­£åœ¨æ’­æ”¾ç›¸é—œå½±ç‰‡...
    </div>

    <div class="container">
        <h1>ğŸ›ï¸ ä¹é¾åŸåœŸç“œç£æ¢ç´¢<br><small>GPSç‰ˆæœ¬ (è‡ªå‹•æ’­æ”¾å½±ç‰‡)</small></h1>
        
        <div class="gps-status" id="gps-status">
            æ­£åœ¨å•Ÿå‹•GPSå®šä½...
        </div>
        
        <div class="progress-container">
            <div>æ¢ç´¢é€²åº¦: <span id="progress-count">0</span>/6</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-text">
                <span>å·²å®Œæˆ: <span id="progress-percent">0</span>%</span>
                <span>å‰©é¤˜: <span id="remaining-percent">100</span>%</span>
            </div>
        </div>

        <!-- åœ°é»1: ä¹é¾å¯¨åŸå…¬åœ’ -->
        <div id="location-1" class="location-card" style="display:none;">
            <h2>ğŸ“ ä¹é¾å¯¨åŸå…¬åœ’</h2>
            <p><strong>æ•…äº‹:</strong> é€™è£¡æ›¾æ˜¯å……æ»¿å‚³å¥‡çš„ä¹é¾å¯¨åŸï¼Œä¸€å€‹åœ¨ä¸‰ä¸ç®¡åœ°å¸¶ä¸­è‡ªç„¶å½¢æˆçš„ç¨ç‰¹ç¤¾å€ã€‚æƒ³åƒä¸€ä¸‹ï¼Œåœ¨1987å¹´æ¸…æ‹†ä¹‹å‰ï¼Œé€™è£¡æ˜¯é«˜å¯†åº¦å»ºç¯‰çš„è¿·å®®ï¼Œå……æ»¿è‘—å„ç¨®æ•…äº‹å’Œå‚³å¥‡ã€‚</p>
            
            <div class="ar-note">
                ğŸ’¡ GPSç‰ˆæœ¬ä¸­ï¼Œç•¶æ‚¨åˆ°é”æ­¤åœ°é»æ™‚ï¼Œæœƒè‡ªå‹•é¡¯ç¤ºç›¸é—œçš„ARå½±ç‰‡å…§å®¹
            </div>
            
            <div class="button-group">
                <button class="btn btn-video" onclick="showVideo(1, 'history')">ğŸ¬ è§€çœ‹ä¹é¾å¯¨åŸæ­·å²å½±ç‰‡</button>
                <button class="btn btn-story" onclick="showVideo(1, 'story')">ğŸ“– æ•…äº‹é€²åº¦</button>
            </div>
            
            <p><strong>å•é¡Œ:</strong> ä¹é¾å¯¨åŸå…¬åœ’ä¿ç•™äº†æ¸…ä»£è¡™é–€çš„å“ªå€‹é‡è¦å»ºç¯‰çµæ§‹ï¼Ÿ</p>
            <input type="text" id="answer-1" placeholder="è¼¸å…¥æ‚¨çš„ç­”æ¡ˆ">
            
            <div class="button-group">
                <button class="btn" onclick="checkAnswer(1, 'è¡™é–€')">æäº¤ç­”æ¡ˆ</button>
                <button class="btn btn-hint" onclick="showHint(1)">ğŸ’¡ é¡¯ç¤ºæç¤º (<span id="hint-count-1">0</span>/3)</button>
            </div>
            
            <div class="hint-counter">é»æ“Šæç¤ºæŒ‰éˆ•ç²å¾—æ›´å¤šç·šç´¢</div>
        </div>

        <!-- åœ°é»2: åä¸‰è¡—èˆŠæ¨“ç¾¤ -->
        <div id="location-2" class="location-card" style="display:none;">
            <h2>ğŸ¢ åä¸‰è¡—èˆŠæ¨“ç¾¤</h2>
            <p><strong>æ•…äº‹:</strong> åä¸‰è¡—è¦‹è­‰äº†åœŸç“œç£çš„å·¥æ¥­ç™¼å±•å²ã€‚é€™äº›æˆ°å‰é¨æ¨“å»ºç¯‰èåˆäº†ä¸­è¥¿å»ºç¯‰é¢¨æ ¼ï¼Œæ›¾ç¶“æ˜¯ç¹è¯çš„å•†æ¥­è¡—é“ï¼Œç¾åœ¨å‰‡æ˜¯ç¤¾å€ç”Ÿæ´»çš„è¦‹è­‰ã€‚</p>
            
            <div class="ar-note">
                ğŸ’¡ GPSç‰ˆæœ¬ä¸­ï¼Œç•¶æ‚¨åˆ°é”æ­¤åœ°é»æ™‚ï¼Œæœƒè‡ªå‹•é¡¯ç¤ºç›¸é—œçš„ARå½±ç‰‡å…§å®¹
            </div>
            
            <div class="button-group">
                <button class="btn btn-video" onclick="showVideo(2, 'history')">ğŸ¬ è§€çœ‹åä¸‰è¡—æ­·å²å½±ç‰‡</button>
                <button class="btn btn-story" onclick="showVideo(2, 'story')">ğŸ“– æ•…äº‹é€²åº¦</button>
            </div>
            
            <p><strong>å•é¡Œ:</strong> åä¸‰è¡—çš„é¨æ¨“å»ºç¯‰ä¸»è¦å»ºæ–¼å“ªå€‹å¹´ä»£ï¼Ÿ</p>
            <input type="text" id="answer-2" placeholder="è¼¸å…¥æ‚¨çš„ç­”æ¡ˆ">
            
            <div class="button-group">
                <button class="btn" onclick="checkAnswer(2, '1950')">æäº¤ç­”æ¡ˆ</button>
                <button class="btn btn-hint" onclick="showHint(2)">ğŸ’¡ é¡¯ç¤ºæç¤º (<span id="hint-count-2">0</span>/3)</button>
            </div>
            
            <div class="hint-counter">é»æ“Šæç¤ºæŒ‰éˆ•ç²å¾—æ›´å¤šç·šç´¢</div>
        </div>

        <!-- åœ°é»3: åœŸç“œç£ç‰›æ£šè—è¡“æ‘ -->
        <div id="location-3" class="location-card" style="display:none;">
            <h2>ğŸ¨ åœŸç“œç£ç‰›æ£šè—è¡“æ‘</h2>
            <p><strong>æ•…äº‹:</strong> é€™è£¡æ›¾æ˜¯é¦™æ¸¯å”¯ä¸€çš„å¸‚å€å± å®°å ´ï¼Œå»ºæ–¼1908å¹´ã€‚ç¶“éæ´»åŒ–å¾Œï¼Œç´…ç£šå»ºç¯‰ç¾¤è®Šæˆäº†è—è¡“å®¶çš„å·¥ä½œå®¤å’Œå±•è¦½ç©ºé–“ï¼Œè¦‹è­‰äº†åŸå¸‚ç©ºé–“åŠŸèƒ½çš„è½‰è®Šã€‚</p>
            
            <div class="ar-note">
                ğŸ’¡ GPSç‰ˆæœ¬ä¸­ï¼Œç•¶æ‚¨åˆ°é”æ­¤åœ°é»æ™‚ï¼Œæœƒè‡ªå‹•é¡¯ç¤ºç›¸é—œçš„ARå½±ç‰‡å…§å®¹
            </div>
            
            <div class="button-group">
                <button class="btn btn-video" onclick="showVideo(3, 'history')">ğŸ¬ è§€çœ‹ç‰›æ£šè—è¡“æ‘å½±ç‰‡</button>
                <button class="btn btn-story" onclick="showVideo(3, 'story')">ğŸ“– æ•…äº‹é€²åº¦</button>
            </div>
            
            <p><strong>å•é¡Œ:</strong> ç‰›æ£šè—è¡“æ‘çš„å‰èº«æ˜¯ä»€éº¼å»ºç¯‰ï¼Ÿ</p>
            <input type="text" id="answer-3" placeholder="è¼¸å…¥æ‚¨çš„ç­”æ¡ˆ">
            
            <div class="button-group">
                <button class="btn" onclick="checkAnswer(3, 'å± å®°å ´')">æäº¤ç­”æ¡ˆ</button>
                <button class="btn btn-hint" onclick="showHint(3)">ğŸ’¡ é¡¯ç¤ºæç¤º (<span id="hint-count-3">0</span>/3)</button>
            </div>
            
            <div class="hint-counter">é»æ“Šæç¤ºæŒ‰éˆ•ç²å¾—æ›´å¤šç·šç´¢</div>
        </div>

        <!-- åœ°é»4: æµ·å¿ƒå…¬åœ’ -->
        <div id="location-4" class="location-card" style="display:none;">
            <h2>ğŸŒŠ æµ·å¿ƒå…¬åœ’</h2>
            <p><strong>æ•…äº‹:</strong> æµ·å¿ƒå…¬åœ’ä»¥ç¨ç‰¹çš„é­šå°¾çŸ³èåï¼Œé€™è£¡æ›¾ç¶“æ˜¯æµ·é‚Šï¼Œæ¼æ°‘æœƒåœ¨æ­¤ç¥ˆæ±‚å¹³å®‰ã€‚å…¬åœ’å…§é‚„æœ‰é„­æˆåŠŸçŸ³åƒï¼Œè¨´èªªè‘—é¦™æ¸¯èˆ‡æµ·æ´‹çš„æ·±åšæ·µæºã€‚</p>
            
            <div class="ar-note">
                ğŸ’¡ GPSç‰ˆæœ¬ä¸­ï¼Œç•¶æ‚¨åˆ°é”æ­¤åœ°é»æ™‚ï¼Œæœƒè‡ªå‹•é¡¯ç¤ºç›¸é—œçš„ARå½±ç‰‡å…§å®¹
            </div>
            
            <div class="button-group">
                <button class="btn btn-video" onclick="showVideo(4, 'history')">ğŸ¬ è§€çœ‹æµ·å¿ƒå…¬åœ’å½±ç‰‡</button>
                <button class="btn btn-story" onclick="showVideo(4, 'story')">ğŸ“– æ•…äº‹é€²åº¦</button>
            </div>
            
            <p><strong>å•é¡Œ:</strong> æµ·å¿ƒå…¬åœ’æœ€è‘—åçš„è‡ªç„¶æ™¯è§€æ˜¯ä»€éº¼çŸ³ï¼Ÿ</p>
            <input type="text" id="answer-4" placeholder="è¼¸å…¥æ‚¨çš„ç­”æ¡ˆ">
            
            <div class="button-group">
                <button class="btn" onclick="checkAnswer(4, 'é­šå°¾çŸ³')">æäº¤ç­”æ¡ˆ</button>
                <button class="btn btn-hint" onclick="showHint(4)">ğŸ’¡ é¡¯ç¤ºæç¤º (<span id="hint-count-4">0</span>/3)</button>
            </div>
            
            <div class="hint-counter">é»æ“Šæç¤ºæŒ‰éˆ•ç²å¾—æ›´å¤šç·šç´¢</div>
        </div>

        <!-- åœ°é»5: å®‹çš‡è‡ºå…¬åœ’ -->
        <div id="location-5" class="location-card" style="display:none;">
            <h2>ğŸ‘‘ å®‹çš‡è‡ºå…¬åœ’</h2>
            <p><strong>æ•…äº‹:</strong> é€™è£¡æ˜¯å—å®‹æœ€å¾Œå…©ä½çš‡å¸é€ƒé¿å…ƒè»çš„åœ°æ–¹ã€‚ã€å®‹çš‡è‡ºã€çŸ³åˆ»è¦‹è­‰äº†é¦™æ¸¯åœ¨ä¸­åœ‹æ­·å²ä¸­çš„é‡è¦åœ°ä½ï¼Œæ˜¯é¦™æ¸¯æœ€å¤è€çš„æ­·å²éºè·¡ä¹‹ä¸€ã€‚</p>
            
            <div class="ar-note">
                ğŸ’¡ GPSç‰ˆæœ¬ä¸­ï¼Œç•¶æ‚¨åˆ°é”æ­¤åœ°é»æ™‚ï¼Œæœƒè‡ªå‹•é¡¯ç¤ºç›¸é—œçš„ARå½±ç‰‡å…§å®¹
            </div>
            
            <div class="button-group">
                <button class="btn btn-video" onclick="showVideo(5, 'history')">ğŸ¬ è§€çœ‹å®‹çš‡è‡ºæ­·å²å½±ç‰‡</button>
                <button class="btn btn-story" onclick="showVideo(5, 'story')">ğŸ“– æ•…äº‹é€²åº¦</button>
            </div>
            
            <p><strong>å•é¡Œ:</strong> å®‹çš‡è‡ºç´€å¿µçš„æ˜¯å“ªå€‹æœä»£çš„çš‡å¸ï¼Ÿ</p>
            <input type="text" id="answer-5" placeholder="è¼¸å…¥æ‚¨çš„ç­”æ¡ˆ">
            
            <div class="button-group">
                <button class="btn" onclick="checkAnswer(5, 'å—å®‹')">æäº¤ç­”æ¡ˆ</button>
                <button class="btn btn-hint" onclick="showHint(5)">ğŸ’¡ é¡¯ç¤ºæç¤º (<span id="hint-count-5">0</span>/3)</button>
            </div>
            
            <div class="hint-counter">é»æ“Šæç¤ºæŒ‰éˆ•ç²å¾—æ›´å¤šç·šç´¢</div>
        </div>

        <!-- åœ°é»6: ç´…ç£¡è§€éŸ³å»Ÿ -->
        <div id="location-6" class="location-card" style="display:none;">
            <h2>ğŸ™ ç´…ç£¡è§€éŸ³å»Ÿ</h2>
            <p><strong>æ•…äº‹:</strong> å»ºæ–¼1873å¹´çš„ç´…ç£¡è§€éŸ³å»Ÿæ˜¯é¦™æ¸¯äºŒç´šæ­·å²å»ºç¯‰ï¼Œè¦‹è­‰äº†ç´…ç£¡åœ°å€çš„ç™¼å±•ã€‚é€™è£¡ä¸åƒ…æ˜¯å®—æ•™å ´æ‰€ï¼Œæ›´æ˜¯ç¤¾å€å‡èšçš„é‡è¦ç©ºé–“ã€‚</p>
            
            <div class="ar-note">
                ğŸ’¡ GPSç‰ˆæœ¬ä¸­ï¼Œç•¶æ‚¨åˆ°é”æ­¤åœ°é»æ™‚ï¼Œæœƒè‡ªå‹•é¡¯ç¤ºç›¸é—œçš„ARå½±ç‰‡å…§å®¹
            </div>
            
            <div class="button-group">
                <button class="btn btn-video" onclick="showVideo(6, 'history')">ğŸ¬ è§€çœ‹ç´…ç£¡è§€éŸ³å»Ÿå½±ç‰‡</button>
                <button class="btn btn-story" onclick="showVideo(6, 'story')">ğŸ“– æ•…äº‹é€²åº¦</button>
            </div>
            
            <p><strong>å•é¡Œ:</strong> ç´…ç£¡è§€éŸ³å»Ÿä¸»è¦ä¾›å¥‰å“ªä½ç¥ç¥‡ï¼Ÿ</p>
            <input type="text" id="answer-6" placeholder="è¼¸å…¥æ‚¨çš„ç­”æ¡ˆ">
            
            <div class="button-group">
                <button class="btn" onclick="checkAnswer(6, 'è§€éŸ³')">æäº¤ç­”æ¡ˆ</button>
                <button class="btn btn-hint" onclick="showHint(6)">ğŸ’¡ é¡¯ç¤ºæç¤º (<span id="hint-count-6">0</span>/3)</button>
            </div>
            
            <div class="hint-counter">é»æ“Šæç¤ºæŒ‰éˆ•ç²å¾—æ›´å¤šç·šç´¢</div>
        </div>

        <!-- å®Œæˆæ…¶ç¥ -->
        <div id="completion" class="completion">
            <h2>ğŸ‰ æ­å–œæ‚¨å®Œæˆæ‰€æœ‰æ¢ç´¢ï¼</h2>
            <p>æ‚¨å·²æˆåŠŸå®Œæˆä¹é¾åŸåœŸç“œç£çš„6å€‹æ­·å²åœ°é»æ¢ç´¢ï¼</p>
            
            <div class="qr-code">
                <h3>å®Œæˆçå‹µäºŒç¶­ç¢¼</h3>
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=0168" alt="å®Œæˆçå‹µäºŒç¶­ç¢¼">
                <p class="qr-instruction">æƒææ­¤äºŒç¶­ç¢¼å¯ç²å¾—æ•¸å­—ä»£ç¢¼: 0168</p>
            </div>
            
            <button class="btn btn-success" onclick="resetGame()">é‡æ–°é–‹å§‹éŠæˆ²</button>
        </div>

        <!-- é–‹ç™¼è€…å·¥å…· -->
        <div class="dev-tools">
            <h3>ğŸ”§ é–‹ç™¼è€…å·¥å…·</h3>
            <p>å¿«é€Ÿè·³è½‰åˆ°ä»»æ„åœ°é»ï¼š</p>
            <div class="button-group">
                <button class="btn btn-dev" onclick="skipToLocation(1)">åœ°é»1</button>
                <button class="btn btn-dev" onclick="skipToLocation(2)">åœ°é»2</button>
                <button class="btn btn-dev" onclick="skipToLocation(3)">åœ°é»3</button>
                <button class="btn btn-dev" onclick="skipToLocation(4)">åœ°é»4</button>
                <button class="btn btn-dev" onclick="skipToLocation(5)">åœ°é»5</button>
                <button class="btn btn-dev" onclick="skipToLocation(6)">åœ°é»6</button>
                <button class="btn btn-success" onclick="completeGame()">ç›´æ¥å®ŒæˆéŠæˆ²</button>
            </div>
            <p>GPSæ¨¡æ“¬ï¼š</p>
            <div class="button-group">
                <button class="btn btn-dev" onclick="simulateLocation(1)">æ¨¡æ“¬åˆ°é”åœ°é»1</button>
                <button class="btn btn-dev" onclick="simulateLocation(2)">æ¨¡æ“¬åˆ°é”åœ°é»2</button>
                <button class="btn btn-dev" onclick="simulateLocation(3)">æ¨¡æ“¬åˆ°é”åœ°é»3</button>
            </div>
        </div>
    </div>

    <!-- å½±ç‰‡æ¨¡æ…‹æ¡† -->
    <div id="video-modal" class="video-modal">
        <div class="video-content">
            <h2 id="video-title">å½±ç‰‡æ¨™é¡Œ</h2>
            <p class="video-description" id="video-description">å½±ç‰‡æè¿°å°‡é¡¯ç¤ºåœ¨é€™è£¡</p>
            
            <div class="video-container">
                <iframe id="video-player" width="560" height="315" src="" frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
                </iframe>
            </div>
            
            <p class="ar-note">åœ¨GPSç‰ˆæœ¬ä¸­ï¼Œé€™æ®µå½±ç‰‡æœƒåœ¨æ‚¨åˆ°é”åœ°é»æ™‚è‡ªå‹•æ’­æ”¾ï¼Œä¸¦èˆ‡å¯¦æ™¯çµåˆ</p>
            
            <button class="close-btn" onclick="closeVideo()">é—œé–‰å½±ç‰‡</button>
        </div>
    </div>

    <script>
        let currentLocation = 0;
        const totalLocations = 6;
        let watchId = null;
        
        // æ¯å€‹åœ°é»çš„æç¤ºè¨ˆæ•¸å™¨
        const hintCounters = {
            1: 0,
            2: 0,
            3: 0,
            4: 0,
            5: 0,
            6: 0
        };
        
        // æ¯å€‹åœ°é»çš„æç¤ºå…§å®¹
        const hintContents = {
            1: {
                1: 'æç¤ºï¼šç­”æ¡ˆå°±åœ¨å•é¡Œä¸­ï¼ç•™æ„ã€Œè¡™é–€ã€é€™å€‹è©ã€‚',
                2: 'æç¤ºï¼šæ¸…ä»£è¡™é–€çš„é‡è¦å»ºç¯‰çµæ§‹å°±æ˜¯ã€Œè¡™é–€ã€æœ¬èº«ã€‚',
                3: 'ç­”æ¡ˆï¼šè¡™é–€'
            },
            2: {
                1: 'æç¤ºï¼šæƒ³æƒ³é¦™æ¸¯æˆ°å¾Œé‡å»ºçš„æ™‚æœŸï¼Œç­”æ¡ˆæ˜¯å››ä½æ•¸å­—ã€‚',
                2: 'æç¤ºï¼š1950å¹´ä»£æ˜¯é¦™æ¸¯æˆ°å¾Œé‡å»ºçš„é‡è¦æ™‚æœŸã€‚',
                3: 'ç­”æ¡ˆï¼š1950'
            },
            3: {
                1: 'æç¤ºï¼šé€™å€‹åœ°æ–¹åŸæœ¬çš„ç”¨é€”èˆ‡ã€Œç‰›ã€æœ‰é—œï¼Œç­”æ¡ˆæ˜¯ä¸‰å€‹å­—ã€‚',
                2: 'æç¤ºï¼šé€™è£¡åŸæœ¬æ˜¯è™•ç†ç‰›éš»çš„åœ°æ–¹ã€‚',
                3: 'ç­”æ¡ˆï¼šå± å®°å ´'
            },
            4: {
                1: 'æç¤ºï¼šé€™å€‹çŸ³é ­å½¢ç‹€åƒä¸€ç¨®æµ·æ´‹ç”Ÿç‰©çš„å°¾å·´ã€‚',
                2: 'æç¤ºï¼šç­”æ¡ˆåœ¨å•é¡Œä¸­å·²ç¶“æåˆ°äº†ï¼Œæ˜¯ã€Œé­šå°¾çŸ³ã€ã€‚',
                3: 'ç­”æ¡ˆï¼šé­šå°¾çŸ³'
            },
            5: {
                1: 'æç¤ºï¼šé€™å€‹æœä»£åœ¨å”æœä¹‹å¾Œï¼Œå…ƒæœä¹‹å‰ã€‚',
                2: 'æç¤ºï¼šé€™å€‹æœä»£æœ‰ã€ŒåŒ—å®‹ã€å’Œã€Œå—å®‹ã€å…©å€‹æ™‚æœŸï¼Œç­”æ¡ˆæ˜¯å“ªä¸€å€‹ï¼Ÿ',
                3: 'ç­”æ¡ˆï¼šå—å®‹'
            },
            6: {
                1: 'æç¤ºï¼šå»Ÿå®‡çš„åç¨±å·²ç¶“å‘Šè¨´ä½ äº†ã€‚',
                2: 'æç¤ºï¼šç­”æ¡ˆå°±æ˜¯ã€Œè§€éŸ³ã€ã€‚',
                3: 'ç­”æ¡ˆï¼šè§€éŸ³'
            }
        };
        
        // æ¯å€‹åœ°é»çš„å½±ç‰‡è³‡è¨Š
        const videoData = {
            1: {
                history: {
                    title: "ä¹é¾å¯¨åŸæ­·å²",
                    description: "æ¢ç´¢ä¹é¾å¯¨åŸçš„å‚³å¥‡æ­·å²ï¼Œå¾æ¸…ä»£è»äº‹è¦å¡åˆ°ç¨ç‰¹çš„åŸä¸­åŸç¤¾å€",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                },
                story: {
                    title: "ä¹é¾å¯¨åŸæ•…äº‹é€²åº¦",
                    description: "äº†è§£ä¹é¾å¯¨åŸçš„ç™¼å±•æ­·ç¨‹èˆ‡ç¤¾å€è®Šé·",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                }
            },
            2: {
                history: {
                    title: "åä¸‰è¡—èˆŠæ¨“ç¾¤æ•…äº‹", 
                    description: "äº†è§£åä¸‰è¡—æˆ°å‰é¨æ¨“å»ºç¯‰çš„æ­·å²èˆ‡å»ºç¯‰ç‰¹è‰²",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                },
                story: {
                    title: "åä¸‰è¡—ç™¼å±•æ•…äº‹",
                    description: "æ¢ç´¢åä¸‰è¡—å¾å•†æ¥­ç¹è¯åˆ°ç¤¾å€è¨˜æ†¶çš„è½‰è®Š",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                }
            },
            3: {
                history: {
                    title: "ç‰›æ£šè—è¡“æ‘è½‰å‹",
                    description: "è¦‹è­‰å¾å± å®°å ´åˆ°è—è¡“ç©ºé–“çš„è¯éº—è½‰èº«",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                },
                story: {
                    title: "ç‰›æ£šè—è¡“æ‘æ•…äº‹",
                    description: "äº†è§£ç‰›æ£šè—è¡“æ‘çš„æ´»åŒ–éç¨‹èˆ‡è—è¡“å®¶æ•…äº‹",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                }
            },
            4: {
                history: {
                    title: "æµ·å¿ƒå…¬åœ’èˆ‡é­šå°¾çŸ³å‚³èªª",
                    description: "æ¢ç´¢æµ·å¿ƒå…¬åœ’çš„è‡ªç„¶æ™¯è§€èˆ‡æ¼æ°‘æ–‡åŒ–",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                },
                story: {
                    title: "æµ·å¿ƒå…¬åœ’æ•…äº‹",
                    description: "äº†è§£æµ·å¿ƒå…¬åœ’çš„æ­·å²è®Šé·èˆ‡ç¤¾å€åŠŸèƒ½",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                }
            },
            5: {
                history: {
                    title: "å®‹çš‡è‡ºæ­·å²éºè·¡",
                    description: "è¿½æº¯å—å®‹çš‡å®¤åœ¨é¦™æ¸¯çš„æ­·å²è¹¤è·¡",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                },
                story: {
                    title: "å®‹çš‡è‡ºæ•…äº‹",
                    description: "äº†è§£å®‹çš‡è‡ºçš„æ­·å²æ„ç¾©èˆ‡æ–‡åŒ–åƒ¹å€¼",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                }
            },
            6: {
                history: {
                    title: "ç´…ç£¡è§€éŸ³å»Ÿæ–‡åŒ–",
                    description: "äº†è§£ç´…ç£¡è§€éŸ³å»Ÿçš„å»ºç¯‰ç‰¹è‰²èˆ‡ç¤¾å€åŠŸèƒ½",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                },
                story: {
                    title: "ç´…ç£¡è§€éŸ³å»Ÿæ•…äº‹",
                    description: "æ¢ç´¢ç´…ç£¡è§€éŸ³å»Ÿçš„æ­·å²èˆ‡ç¤¾å€é€£çµ",
                    youtubeId: "dQw4w9WgXcQ" // é€™æ˜¯ç¤ºä¾‹IDï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦çš„å½±ç‰‡ID
                }
            }
        };

        // æ¯å€‹åœ°é»çš„GPSåæ¨™ (ç¤ºä¾‹åæ¨™ï¼Œè«‹æ›¿æ›ç‚ºçœŸå¯¦åæ¨™)
        const locationCoordinates = {
            1: { lat: 22.332, lng: 114.186, radius: 0.001 }, // ä¹é¾å¯¨åŸå…¬åœ’
            2: { lat: 22.320, lng: 114.190, radius: 0.001 }, // åä¸‰è¡—èˆŠæ¨“ç¾¤
            3: { lat: 22.317, lng: 114.189, radius: 0.001 }, // åœŸç“œç£ç‰›æ£šè—è¡“æ‘
            4: { lat: 22.304, lng: 114.195, radius: 0.001 }, // æµ·å¿ƒå…¬åœ’
            5: { lat: 22.327, lng: 114.191, radius: 0.001 }, // å®‹çš‡è‡ºå…¬åœ’
            6: { lat: 22.303, lng: 114.190, radius: 0.001 }  // ç´…ç£¡è§€éŸ³å»Ÿ
        };

        // åˆå§‹åŒ–é€²åº¦é¡¯ç¤º
        updateProgress();
        
        // å•Ÿå‹•GPSç›£æ§
        startGPSMonitoring();

        function startGPSMonitoring() {
            if (navigator.geolocation) {
                document.getElementById('gps-status').textContent = "GPSå®šä½å·²å•Ÿå‹•ï¼Œæ­£åœ¨ç›£æ§æ‚¨çš„ä½ç½®...";
                document.getElementById('gps-status').className = "gps-status gps-active";
                
                // é–‹å§‹ç›£æ§ä½ç½®
                watchId = navigator.geolocation.watchPosition(
                    handlePositionUpdate,
                    handlePositionError,
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 60000
                    }
                );
            } else {
                document.getElementById('gps-status').textContent = "æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æŒGPSå®šä½åŠŸèƒ½";
                document.getElementById('gps-status').className = "gps-status gps-inactive";
            }
        }

        function handlePositionUpdate(position) {
            const userLat = position.coords.latitude;
            const userLng = position.coords.longitude;
            
            // æª¢æŸ¥æ˜¯å¦æ¥è¿‘ä»»ä½•æœªè§£é–çš„åœ°é»
            for (let i = 1; i <= totalLocations; i++) {
                if (i > currentLocation) {
                    const location = locationCoordinates[i];
                    const distance = calculateDistance(userLat, userLng, location.lat, location.lng);
                    
                    if (distance <= location.radius) {
                        // ç”¨æˆ¶åˆ°é”äº†æ–°åœ°é»
                        unlockLocation(i);
                        break;
                    }
                }
            }
        }

        function handlePositionError(error) {
            let errorMessage = "ç„¡æ³•ç²å–æ‚¨çš„ä½ç½®ä¿¡æ¯: ";
            
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    errorMessage += "ç”¨æˆ¶æ‹’çµ•äº†ä½ç½®è«‹æ±‚";
                    break;
                case error.POSITION_UNAVAILABLE:
                    errorMessage += "ä½ç½®ä¿¡æ¯ä¸å¯ç”¨";
                    break;
                case error.TIMEOUT:
                    errorMessage += "ç²å–ä½ç½®ä¿¡æ¯è¶…æ™‚";
                    break;
                default:
                    errorMessage += "æœªçŸ¥éŒ¯èª¤";
                    break;
            }
            
            document.getElementById('gps-status').textContent = errorMessage;
            document.getElementById('gps-status').className = "gps-status gps-inactive";
        }

        function calculateDistance(lat1, lng1, lat2, lng2) {
            // ä½¿ç”¨å“ˆå¼—è¾›å…¬å¼è¨ˆç®—å…©é»é–“è·é›¢ï¼ˆå–®ä½ï¼šå…¬é‡Œï¼‰
            const R = 6371; // åœ°çƒåŠå¾‘ï¼ˆå…¬é‡Œï¼‰
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLng = (lng2 - lng1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLng/2) * Math.sin(dLng/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            const distance = R * c;
            return distance;
        }

        function unlockLocation(locationNum) {
            // é¡¯ç¤ºé€šçŸ¥
            const notification = document.getElementById('location-notification');
            notification.textContent = `ğŸ‰ æ‚¨å·²åˆ°é”${getLocationName(locationNum)}ï¼æ­£åœ¨æ’­æ”¾ç›¸é—œå½±ç‰‡...`;
            notification.style.display = 'block';
            
            // 3ç§’å¾Œéš±è—é€šçŸ¥
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
            
            // æ›´æ–°ç•¶å‰ä½ç½®
            currentLocation = locationNum;
            
            // é¡¯ç¤ºåœ°é»å¡ç‰‡
            document.getElementById('location-' + locationNum).style.display = 'block';
            
            // æ›´æ–°é€²åº¦
            updateProgress();
            
            // è‡ªå‹•æ’­æ”¾å½±ç‰‡ - å…ˆæ’­æ”¾æ•…äº‹å½±ç‰‡ï¼Œç„¶å¾Œæ’­æ”¾æ­·å²å½±ç‰‡
            playStoryVideo(locationNum);
        }

        function playStoryVideo(locationNum) {
            const storyVideo = videoData[locationNum].story;
            if (storyVideo) {
                // é¡¯ç¤ºå½±ç‰‡æ¨¡æ…‹æ¡†
                document.getElementById('video-title').textContent = storyVideo.title;
                document.getElementById('video-description').textContent = storyVideo.description;
                document.getElementById('video-player').src = `https://www.youtube.com/embed/${storyVideo.youtubeId}?autoplay=1`;
                document.getElementById('video-modal').style.display = 'flex';
                
                // ç›£è½å½±ç‰‡çµæŸäº‹ä»¶ï¼Œä»¥ä¾¿æ’­æ”¾æ­·å²å½±ç‰‡
                const iframe = document.getElementById('video-player');
                iframe.onload = function() {
                    // è¨­ç½®å®šæ™‚å™¨æª¢æŸ¥å½±ç‰‡æ˜¯å¦çµæŸï¼ˆé€™æ˜¯ä¸€å€‹ç°¡åŒ–æ–¹æ¡ˆï¼Œå¯¦éš›æ‡‰ç”¨ä¸­æ‡‰ä½¿ç”¨YouTube APIï¼‰
                    setTimeout(() => {
                        // å‡è¨­å½±ç‰‡é•·åº¦ç‚º3åˆ†é˜ï¼Œ3åˆ†é˜å¾Œè‡ªå‹•æ’­æ”¾æ­·å²å½±ç‰‡
                        playHistoryVideo(locationNum);
                    }, 180000); // 3åˆ†é˜
                };
            }
        }

        function playHistoryVideo(locationNum) {
            const historyVideo = videoData[locationNum].history;
            if (historyVideo) {
                // é¡¯ç¤ºå½±ç‰‡æ¨¡æ…‹æ¡†
                document.getElementById('video-title').textContent = historyVideo.title;
                document.getElementById('video-description').textContent = historyVideo.description;
                document.getElementById('video-player').src = `https://www.youtube.com/embed/${historyVideo.youtubeId}?autoplay=1`;
                document.getElementById('video-modal').style.display = 'flex';
            }
        }

        function getLocationName(locationNum) {
            const names = {
                1: "ä¹é¾å¯¨åŸå…¬åœ’",
                2: "åä¸‰è¡—èˆŠæ¨“ç¾¤",
                3: "åœŸç“œç£ç‰›æ£šè—è¡“æ‘",
                4: "æµ·å¿ƒå…¬åœ’",
                5: "å®‹çš‡è‡ºå…¬åœ’",
                6: "ç´…ç£¡è§€éŸ³å»Ÿ"
            };
            return names[locationNum] || "æœªçŸ¥åœ°é»";
        }

        function checkAnswer(locationNum, correctAnswer) {
            const userAnswer = document.getElementById('answer-' + locationNum).value.trim().toLowerCase();
            const correct = correctAnswer.toLowerCase();
            
            // æ›´å¯¬é¬†çš„ç­”æ¡ˆæª¢æŸ¥
            let isCorrect = false;
            
            // æª¢æŸ¥å®Œå…¨åŒ¹é…
            if (userAnswer === correct) {
                isCorrect = true;
            }
            // æª¢æŸ¥åŒ…å«é—œä¿‚
            else if (userAnswer.includes(correct) || correct.includes(userAnswer)) {
                isCorrect = true;
            }
            // ç‰¹æ®Šæƒ…æ³ï¼šæ•¸å­—ç­”æ¡ˆ
            else if (correct === '1950' && (userAnswer === '50å¹´ä»£' || userAnswer === 'äº”åå¹´ä»£')) {
                isCorrect = true;
            }
            
            if (isCorrect) {
                alert('âœ… ç­”æ¡ˆæ­£ç¢ºï¼æ­å–œæ‚¨å®Œæˆé€™å€‹åœ°é»çš„æ¢ç´¢ï¼');
                
                // æ¸…ç©ºç­”æ¡ˆæ¡†
                document.getElementById('answer-' + locationNum).value = '';
                
            } else {
                alert('âŒ ç­”æ¡ˆä¸æ­£ç¢ºï¼Œè«‹å†è©¦ä¸€æ¬¡æˆ–æŸ¥çœ‹æç¤ºã€‚\n\næç¤ºï¼šç­”æ¡ˆé€šå¸¸æ˜¯1-3å€‹å­—çš„é—œéµè©ã€‚');
            }
        }

        function showHint(locationNum) {
            // å¢åŠ æç¤ºè¨ˆæ•¸
            hintCounters[locationNum]++;
            
            // æ›´æ–°æç¤ºæŒ‰éˆ•ä¸Šçš„è¨ˆæ•¸
            document.getElementById('hint-count-' + locationNum).textContent = hintCounters[locationNum];
            
            // æ ¹æ“šæç¤ºæ¬¡æ•¸é¡¯ç¤ºä¸åŒçš„æç¤º
            const hintLevel = Math.min(hintCounters[locationNum], 3);
            
            if (hintContents[locationNum] && hintContents[locationNum][hintLevel]) {
                alert(hintContents[locationNum][hintLevel]);
            }
            
            // å¦‚æœå·²ç¶“é¡¯ç¤ºäº†ç­”æ¡ˆï¼Œå‰‡ç¦ç”¨æç¤ºæŒ‰éˆ•
            if (hintLevel >= 3) {
                document.querySelector(`#location-${locationNum} .btn-hint`).disabled = true;
            }
        }

        function showVideo(locationNum, type) {
            const videoInfo = videoData[locationNum][type];
            if (videoInfo) {
                document.getElementById('video-title').textContent = videoInfo.title;
                document.getElementById('video-description').textContent = videoInfo.description;
                document.getElementById('video-player').src = `https://www.youtube.com/embed/${videoInfo.youtubeId}`;
                document.getElementById('video-modal').style.display = 'flex';
            }
        }

        function closeVideo() {
            document.getElementById('video-modal').style.display = 'none';
            document.getElementById('video-player').src = '';
        }

        function updateProgress() {
            const progressPercent = Math.round((currentLocation / totalLocations) * 100);
            const remainingPercent = 100 - progressPercent;
            
            document.getElementById('progress-count').textContent = currentLocation;
            document.getElementById('progress-percent').textContent = progressPercent;
            document.getElementById('remaining-percent').textContent = remainingPercent;
            document.getElementById('progress-fill').style.width = `${progressPercent}%`;
            
            // å¦‚æœæ‰€æœ‰åœ°é»éƒ½å·²è§£é–ï¼Œé¡¯ç¤ºå®Œæˆç•«é¢
            if (currentLocation >= totalLocations) {
                setTimeout(() => {
                    completeGame();
                }, 2000);
            }
        }

        function skipToLocation(locationNum) {
            // æ›´æ–°ç•¶å‰ä½ç½®
            currentLocation = locationNum;
            
            // éš±è—æ‰€æœ‰åœ°é»
            for (let i = 1; i <= totalLocations; i++) {
                document.getElementById('location-' + i).style.display = 'none';
            }
            
            // é¡¯ç¤ºæŒ‡å®šåœ°é»
            document.getElementById('location-' + locationNum).style.display = 'block';
            
            updateProgress();
        }

        function completeGame() {
            // éš±è—æ‰€æœ‰åœ°é»
            for (let i = 1; i <= totalLocations; i++) {
                document.getElementById('location-' + i).style.display = 'none';
            }
            
            // é¡¯ç¤ºå®Œæˆç•«é¢
            document.getElementById('completion').style.display = 'block';
            
            // æ›´æ–°é€²åº¦
            currentLocation = totalLocations;
            updateProgress();
        }

        function resetGame() {
            // é‡ç½®æ‰€æœ‰ç‹€æ…‹
            currentLocation = 0;
            
            // é‡ç½®æç¤ºè¨ˆæ•¸å™¨
            for (let i = 1; i <= totalLocations; i++) {
                hintCounters[i] = 0;
                document.getElementById('hint-count-' + i).textContent = '0';
                document.querySelector(`#location-${i} .btn-hint`).disabled = false;
                document.getElementById('answer-' + i).value = '';
                document.getElementById('location-' + i).style.display = 'none';
            }
            
            // éš±è—å®Œæˆç•«é¢
            document.getElementById('completion').style.display = 'none';
            
            // é‡æ–°å•Ÿå‹•GPSç›£æ§
            if (watchId) {
                navigator.geolocation.clearWatch(watchId);
            }
            startGPSMonitoring();
            
            updateProgress();
        }

        function simulateLocation(locationNum) {
            // æ¨¡æ“¬åˆ°é”æŒ‡å®šåœ°é»
            unlockLocation(locationNum);
        }

        // é»æ“Šæ¨¡æ…‹æ¡†å¤–éƒ¨é—œé–‰å½±ç‰‡
        document.getElementById('video-modal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeVideo();
            }
        });
    </script>
</body>
</html>
